<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Documentation for `get_ml_data_and_tuned_hyperparameters` Function • SENDQSAR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Documentation for `get_ml_data_and_tuned_hyperparameters` Function">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SENDQSAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/get_compile_data.html">get_compile_data</a></li>
    <li><a class="dropdown-item" href="../articles/get_bw_score.html">get_bw_score</a></li>
    <li><a class="dropdown-item" href="../articles/get_livertobw_score.html">get_livertobw_score</a></li>
    <li><a class="dropdown-item" href="../articles/get_lb_score.html">get_lb_score</a></li>
    <li><a class="dropdown-item" href="../articles/get_mi_score.html">get_mi_score</a></li>
    <li><a class="dropdown-item" href="../articles/get_liver_om_lb_mi_tox_score_list.html">get_liver_om_lb_mi_tox_score_list</a></li>
    <li><a class="dropdown-item" href="../articles/get_col_harmonized_scores_df.html">get_col_harmonized_scores_df</a></li>
    <li><a class="dropdown-item" href="../articles/get_ml_data_and_tuned_hyperparameters.html">get_ml_data_and_tuned_hyperparameters</a></li>
    <li><a class="dropdown-item" href="../articles/get_rf_model_with_cv.html">get_rf_model_with_cv</a></li>
    <li><a class="dropdown-item" href="../articles/get_zone_exclusioned_rf_model_with_cv.html">get_zone_exclusioned_rf_model_with_cv</a></li>
    <li><a class="dropdown-item" href="../articles/get_imp_features_from_rf_model_with_cv.html">get_imp_features_from_rf_model_with_cv</a></li>
    <li><a class="dropdown-item" href="../articles/get_auc_curve_with_rf_model.html">get_auc_curve_with_rf_model</a></li>
    <li><a class="dropdown-item" href="../articles/get_histogram_barplot.html">get_histogram_barplot</a></li>
    <li><a class="dropdown-item" href="../articles/get_reprtree_from_rf_model.html">get_reprtree_from_rf_model</a></li>
    <li><a class="dropdown-item" href="../articles/get_prediction_plot.html">get_prediction_plot</a></li>
    <li><a class="dropdown-item" href="../articles/get_Data_formatted_for_ml_and_best.m.html">get_Data_formatted_for_ml_and_best.m</a></li>
    <li><a class="dropdown-item" href="../articles/get_rf_input_param_list_output_cv_imp.html">get_rf_input_param_list_output_cv_imp</a></li>
    <li><a class="dropdown-item" href="../articles/get_zone_exclusioned_rf_model_cv_imp.html">get_zone_exclusioned_rf_model_cv_imp</a></li>
    <li><a class="dropdown-item" href="../articles/get_repeat_dose_parallel_studyids.html">get_repeat_dose_parallel_studyids</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aminuldu07/SENDQSAR" aria-label="github"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Documentation for `get_ml_data_and_tuned_hyperparameters` Function</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/aminuldu07/SENDQSAR/blob/HEAD/vignettes/get_ml_data_and_tuned_hyperparameters.Rmd" class="external-link"><code>vignettes/get_ml_data_and_tuned_hyperparameters.Rmd</code></a></small>
      <div class="d-none name"><code>get_ml_data_and_tuned_hyperparameters.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>get_ml_data_and_tuned_hyperparameters</code> function
processes and prepares machine learning data for modeling, with various
optional preprocessing steps such as missing value imputation,
undersampling, and hyperparameter tuning. It also supports error
correction via specific methods like “Flip” and “Prune”.</p>
</div>
<div class="section level2">
<h2 id="function-definition">Function Definition<a class="anchor" aria-label="anchor" href="#function-definition"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_ml_data_and_tuned_hyperparameters</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Data</span>,</span>
<span>                                                  <span class="va">studyid_metadata</span>,</span>
<span>                                                  <span class="va">Impute</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                  <span class="va">Round</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                  <span class="va">reps</span>,</span>
<span>                                                  <span class="va">holdback</span>,</span>
<span>                                                  <span class="va">Undersample</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                  <span class="va">hyperparameter_tuning</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                  <span class="va">error_correction_method</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Function implementation</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">get_ml_data_and_tuned_hyperparameters</span>(<span class="at">Data =</span> scores_df,</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>                                               <span class="at">studyid_metadata =</span> metadata_df,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                                               <span class="at">Impute =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                                               <span class="at">Round =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                                               <span class="at">reps =</span> <span class="dv">10</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                                               <span class="at">holdback =</span> <span class="fl">0.25</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>                                               <span class="at">Undersample =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>                                               <span class="at">hyperparameter_tuning =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>                                               <span class="at">error_correction_method =</span> <span class="st">"Flip"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co"># Access the final data and best mtry hyperparameter</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>rfData <span class="ot">&lt;-</span> result<span class="sc">$</span>rfData</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>best_mtry <span class="ot">&lt;-</span> result<span class="sc">$</span>best.m</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="er">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h2>
<ul>
<li><p><strong>Data</strong> (<em>data frame</em>):<br>
Input data containing the scores. This will typically be a data frame
named <code>scores_df</code>.</p></li>
<li><p><strong>studyid_metadata</strong> (<em>data frame</em>):<br>
A data frame containing metadata, typically including the
<code>STUDYID</code> column, which is used for joining with the
<code>Data</code>.</p></li>
<li><p><strong>Impute</strong> (<em>logical</em>):<br>
If <code>TRUE</code>, missing values in the dataset will be imputed
using random forest imputation.</p></li>
<li><p><strong>Round</strong> (<em>logical</em>):<br>
If <code>TRUE</code>, specific columns will be rounded according to the
rules described in the function.</p></li>
<li><p><strong>reps</strong> (<em>numeric</em>):<br>
The number of repetitions for cross-validation. A value of 0 skips
repetition.</p></li>
<li><p><strong>holdback</strong> (<em>numeric</em>):<br>
The fraction of data to hold back for testing. A value of 1 means
leave-one-out cross-validation.</p></li>
<li><p><strong>Undersample</strong> (<em>logical</em>):<br>
If <code>TRUE</code>, the training data will be undersampled to balance
the target classes.</p></li>
<li><p><strong>hyperparameter_tuning</strong> (<em>logical</em>):<br>
If <code>TRUE</code>, hyperparameter tuning will be performed using
cross-validation.</p></li>
<li><p><strong>error_correction_method</strong>
(<em>character</em>):<br>
Specifies the error correction method to use. Can be one of
<code>"Flip"</code>, <code>"Prune"</code>, or <code>"None"</code>.
Defaults to <code>NULL</code>, which means no correction.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a>
</h2>
<ul>
<li>
<strong>A list containing</strong>:
<ul>
<li>
<strong>rfData</strong>:<br>
The final prepared data after preprocessing, imputation, and any error
correction methods.</li>
<li>
<strong>best.m</strong>:<br>
The best <code>mtry</code> hyperparameter for the random forest model
(determined through tuning or default).</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="function-workflow">Function Workflow<a class="anchor" aria-label="anchor" href="#function-workflow"></a>
</h2>
<div class="section level3">
<h3 id="data-merging">Data Merging<a class="anchor" aria-label="anchor" href="#data-merging"></a>
</h3>
<ul>
<li>The function first joins the metadata
(<code>studyid_metadata</code>) with the input data (<code>Data</code>)
based on the <code>STUDYID</code> column.</li>
</ul>
</div>
<div class="section level3">
<h3 id="target-variable-encoding">Target Variable Encoding<a class="anchor" aria-label="anchor" href="#target-variable-encoding"></a>
</h3>
<ul>
<li>The target variable (<code>Target_Organ</code>) is encoded such
that:
<ul>
<li>
<code>'Liver'</code> is encoded as <code>1</code>.</li>
<li>
<code>'not_Liver'</code> is encoded as <code>0</code>.</li>
</ul>
</li>
<li>This encoding facilitates the modeling process.</li>
</ul>
</div>
<div class="section level3">
<h3 id="missing-value-imputation">Missing Value Imputation<a class="anchor" aria-label="anchor" href="#missing-value-imputation"></a>
</h3>
<ul>
<li>If <code>Impute</code> is <code>TRUE</code>, missing values are
imputed using the <code><a href="https://rdrr.io/pkg/randomForest/man/rfImpute.html" class="external-link">randomForest::rfImpute</a></code> function.</li>
</ul>
</div>
<div class="section level3">
<h3 id="rounding-of-specific-columns">Rounding of Specific Columns<a class="anchor" aria-label="anchor" href="#rounding-of-specific-columns"></a>
</h3>
<ul>
<li>If <code>Round</code> is <code>TRUE</code>:
<ul>
<li>Columns related to averages or liver-related data are rounded down
using <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor()</a></code>.</li>
<li>Other columns (e.g., <code>"MI"</code> columns) are rounded up using
<code><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling()</a></code>.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="data-splitting">Data Splitting<a class="anchor" aria-label="anchor" href="#data-splitting"></a>
</h3>
<ul>
<li>The data is split into training and testing sets:
<ul>
<li>A fraction of the data (<code>holdback</code>) is held back for
testing.</li>
<li>For each repetition (<code>reps</code>), the data is split
again.</li>
</ul>
</li>
<li>The training set is optionally undersampled to balance the target
classes.</li>
</ul>
</div>
<div class="section level3">
<h3 id="hyperparameter-tuning">Hyperparameter Tuning<a class="anchor" aria-label="anchor" href="#hyperparameter-tuning"></a>
</h3>
<ul>
<li>If <code>hyperparameter_tuning</code> is <code>TRUE</code>:
<ul>
<li>The function performs hyperparameter tuning for the random forest
model using cross-validation with <code>trainControl</code> from the
<strong>caret</strong> package.</li>
<li>The <code>mtry</code> parameter is tuned, which controls the number
of variables randomly sampled as candidates at each split.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="model-training">Model Training<a class="anchor" aria-label="anchor" href="#model-training"></a>
</h3>
<ul>
<li>A random forest model is trained on the prepared data using the
<strong>randomForest</strong> package.</li>
<li>The <code>best.m</code> hyperparameter is selected based on the
tuning or set to a default value.</li>
</ul>
</div>
<div class="section level3">
<h3 id="error-correction">Error Correction<a class="anchor" aria-label="anchor" href="#error-correction"></a>
</h3>
<ul>
<li>If <code>error_correction_method</code> is specified, the function
corrects the predictions based on the chosen method:
<ul>
<li>
<code>"Flip"</code>: Flips the target class if certain conditions
are met.</li>
<li>
<code>"Prune"</code>: Removes instances that are misclassified.</li>
<li>
<code>"None"</code>: No error correction is applied.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="final-data-return">Final Data Return<a class="anchor" aria-label="anchor" href="#final-data-return"></a>
</h3>
<ul>
<li>The processed data (<code>rfData</code>) and the best
<code>mtry</code> hyperparameter (<code>best.m</code>) are
returned.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Md Aminul Islam Prodhan, Kevin Snyder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
