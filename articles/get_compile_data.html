<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Documentation for 'get_compile_data' Function • SENDQSAR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Documentation for 'get_compile_data' Function">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SENDQSAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/get_compile_data.html">get_compile_data</a></li>
    <li><a class="dropdown-item" href="../articles/get_bw_score.html">get_bw_score</a></li>
    <li><a class="dropdown-item" href="../articles/get_livertobw_score.html">get_livertobw_score</a></li>
    <li><a class="dropdown-item" href="../articles/get_lb_score.html">get_lb_score</a></li>
    <li><a class="dropdown-item" href="../articles/get_mi_score.html">get_mi_score</a></li>
    <li><a class="dropdown-item" href="../articles/get_liver_om_lb_mi_tox_score_list.html">get_liver_om_lb_mi_tox_score_list</a></li>
    <li><a class="dropdown-item" href="../articles/get_col_harmonized_scores_df.html">get_col_harmonized_scores_df</a></li>
    <li><a class="dropdown-item" href="../articles/get_ml_data_and_tuned_hyperparameters.html">get_ml_data_and_tuned_hyperparameters</a></li>
    <li><a class="dropdown-item" href="../articles/get_rf_model_with_cv.html">get_rf_model_with_cv</a></li>
    <li><a class="dropdown-item" href="../articles/get_zone_exclusioned_rf_model_with_cv.html">get_zone_exclusioned_rf_model_with_cv</a></li>
    <li><a class="dropdown-item" href="../articles/get_imp_features_from_rf_model_with_cv.html">get_imp_features_from_rf_model_with_cv</a></li>
    <li><a class="dropdown-item" href="../articles/get_auc_curve_with_rf_model.html">get_auc_curve_with_rf_model</a></li>
    <li><a class="dropdown-item" href="../articles/get_histogram_barplot.html">get_histogram_barplot</a></li>
    <li><a class="dropdown-item" href="../articles/get_reprtree_from_rf_model.html">get_reprtree_from_rf_model</a></li>
    <li><a class="dropdown-item" href="../articles/get_prediction_plot.html">get_prediction_plot</a></li>
    <li><a class="dropdown-item" href="../articles/get_Data_formatted_for_ml_and_best.m.html">get_Data_formatted_for_ml_and_best.m</a></li>
    <li><a class="dropdown-item" href="../articles/get_rf_input_param_list_output_cv_imp.html">get_rf_input_param_list_output_cv_imp</a></li>
    <li><a class="dropdown-item" href="../articles/get_zone_exclusioned_rf_model_cv_imp.html">get_zone_exclusioned_rf_model_cv_imp</a></li>
    <li><a class="dropdown-item" href="../articles/get_repeat_dose_parallel_studyids.html">get_repeat_dose_parallel_studyids</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aminuldu07/SENDQSAR" aria-label="github"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Documentation for 'get_compile_data' Function</h1>
                        <h4 data-toc-skip class="author">Md Aminul Islam
Prodhan</h4>
            
            <h4 data-toc-skip class="date">2025-05-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aminuldu07/SENDQSAR/blob/main/vignettes/get_compile_data.Rmd" class="external-link"><code>vignettes/get_compile_data.Rmd</code></a></small>
      <div class="d-none name"><code>get_compile_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>The <code>get_compile_data</code> function retrieves and cleans study
data from the DM (Demographics) domain by applying multiple filtering
steps and compiles the remaining data into a cleaned format. First, it
removes recovery animals by filtering the DM data using information from
the DS (Disposition) domain. Additionally, if the study involves rats or
mice,the function further filters out toxicokinetic animals by excluding
USUBJIDs present in the Pharmacokinetic (PC) domain. These steps ensure
the data set excludes recovery animals and toxicokinetic (TK) animals,
focusing only onthe target population relevant to the study’s primary
analysis.This function supports data retrieval from both SQLite
databases and <code>.xpt</code> files.</p>
</div>
<div class="section level2">
<h2 id="function-parameters-arguments">Function Parameters (Arguments)<a class="anchor" aria-label="anchor" href="#function-parameters-arguments"></a>
</h2>
<table class="table">
<colgroup>
<col width="11%">
<col width="9%">
<col width="63%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th><strong>Parameter</strong></th>
<th><strong>Type</strong></th>
<th><strong>Description</strong></th>
<th><strong>Mandatory/Default</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>studyid</code></td>
<td>Character</td>
<td>The study ID number, which uniquely identifies the study within the
database.</td>
<td>Mandatory</td>
</tr>
<tr class="even">
<td><code>path_db</code></td>
<td>Character</td>
<td>The path to the database file. This could be a path to an SQLite
database or a directory containing <code>.xpt</code> files.</td>
<td>Mandatory</td>
</tr>
<tr class="odd">
<td><code>fake_study</code></td>
<td>Boolean</td>
<td>Indicates if the study data has been generated using the
<code>SENDsanitizer</code> package.</td>
<td>Optional (Default: FALSE)</td>
</tr>
<tr class="even">
<td><code>use_xpt_file</code></td>
<td>Boolean</td>
<td>Specifies whether to use <code>.xpt</code> file format when dealing
with data generated by the <code>SENDsanitizer</code> package.</td>
<td>Optional (Default: FALSE)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>Returns a cleaned <code>data.frame</code> with the following
columns:</p>
<ul>
<li><code>STUDYID</code></li>
<li><code>USUBJID</code></li>
<li><code>Species</code></li>
<li><code>SEX</code></li>
<li><code>ARMCD</code></li>
<li><code>SETCD</code></li>
</ul>
<p>The cleaned data is now ready to be used for further analysis.</p>
</div>
<div class="section level2">
<h2 id="implementation-details">Implementation Details<a class="anchor" aria-label="anchor" href="#implementation-details"></a>
</h2>
<p>The <code>get_compile_data</code> function leverages the following
steps to calculate the <code>compile_data</code> data frame for a given
study:</p>
<div class="section level3">
<h3 id="database-connection">Database Connection<a class="anchor" aria-label="anchor" href="#database-connection"></a>
</h3>
<p>-This function connects to a SQLite database or reads
<code>.xpt</code> files specified by <code>path_db</code>.</p>
</div>
<div class="section level3">
<h3 id="data-fetching">Data Fetching<a class="anchor" aria-label="anchor" href="#data-fetching"></a>
</h3>
<p>The function retrieves data from the following SEND domains based on
the input parameters:</p>
<ul>
<li>
<code>DM</code> (Demographics): Provides animal-level
information.</li>
<li>
<code>DS</code> (Disposition): Identifies recovery animals using the
<code>DSDECOD</code> column.</li>
<li>
<code>PC</code> (Pharmacokinetics): Excludes TK animals for rats and
mice based on <code>USUBJID</code>.</li>
<li>
<code>TX</code> (Treatment): Determines dose levels such as
“vehicle” or “HD.”</li>
</ul>
</div>
<div class="section level3">
<h3 id="filtering-steps">Filtering Steps<a class="anchor" aria-label="anchor" href="#filtering-steps"></a>
</h3>
<ul>
<li><p><strong>Filtering Recovery Animals</strong><br>
Recovery animals are excluded by filtering the DM data based on
<code>DSDECOD</code> values in the <code>DS</code> domain.</p></li>
<li><p><strong>Filtering Toxicokinetic (TK) Animals</strong><br>
For studies involving rats or mice, the function removes animals whose
<code>USUBJID</code> appears in the PC domain.</p></li>
<li><p><strong>Dose Selection</strong><br>
The function identifies and retains animals assigned to either the
“vehicle” group or the “high-dose” (HD) group by applying dose-ranking
logic from the TX domain, where “Control” groups are reclassified as
“vehicle.”</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="examples-usage">Examples Usage<a class="anchor" aria-label="anchor" href="#examples-usage"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example usage with SQLite database</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_compile_data.html">get_compile_data</a></span><span class="op">(</span></span>
<span>  studyid <span class="op">=</span> <span class="st">"1234123"</span>,</span>
<span>  path_db <span class="op">=</span> <span class="st">"path/to/database.db"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example usage with .xpt files</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_compile_data.html">get_compile_data</a></span><span class="op">(</span></span>
<span>  studyid <span class="op">=</span> <span class="st">"1234123"</span>,</span>
<span>  path_db <span class="op">=</span> <span class="st">"path/to/files"</span>,</span>
<span>  fake_study <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_xpt_file <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="required-libraries">Required Libraries<a class="anchor" aria-label="anchor" href="#required-libraries"></a>
</h2>
<p>This function requires the following R packages:</p>
<ul>
<li><code>DBI</code></li>
<li><code>RSQLite</code></li>
<li><code>data.table</code></li>
<li><code>dplyr</code></li>
<li><code>haven</code></li>
<li><code>tidyr</code></li>
<li><code>stringr</code></li>
</ul>
<p>##Notes</p>
<ul>
<li>The function assumes standard SEND domains and column names.</li>
<li>For non-standard data, adjustments may be needed.</li>
<li>Check your database or <code>.xpt</code> files to ensure
compatibility with the function.</li>
</ul>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li><a href="https://cran.r-project.org/package=DBI" class="external-link">DBI</a></li>
<li><a href="https://cran.r-project.org/package=RSQLite" class="external-link">RSQLite</a></li>
<li><a href="https://cran.r-project.org/package=data.table" class="external-link">data.table</a></li>
<li><a href="https://github.com/phuse-org/SEND-sanitizer" class="external-link">SENDsanitizer</a></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Md Aminul Islam Prodhan, Kevin Snyder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
